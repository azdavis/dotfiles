#!/usr/bin/env zsh

source "$HOME/.config/misc/base.sh" || exit 1

echo -n 'username: ' && read user_name
echo -n 'email: ' && read email
echo -n 'token: ' && read token

git config --global user.name "$user_name"
git config --global user.email "$email"

git credential-osxkeychain erase <<-EOS
host=github.com
protocol=https
EOS
git credential-osxkeychain store <<-EOS
host=github.com
protocol=https
password=$token
username=$user_name
EOS

cat <<-EOS > "$HOME/.config/hub"
github.com:
- user: $user_name
  oauth_token: $token
  protocol: https
EOS
