#!/usr/bin/env zsh

source "$HOME/.config/misc/base.sh" || exit 1

cd "$HOME/.config/pkg"

echo -n 'brew [yn]? ' && read brew
echo -n 'gem [yn]? ' && read gem
echo -n 'npm [yn]? ' && read npm
echo -n 'tlmgr [yn]? ' && read tlmgr

if [[ "$brew" == 'y' ]]; then
  which brew > /dev/null || curl -fsSL 'https://git.io/pVOl' | ruby
  brew update
  brew upgrade
  brew bundle --verbose
  brew bundle cleanup --force
  brew cask cleanup --force
  brew cleanup --force
  brew prune
  brew doctor || true
fi
if [[ "$gem" == 'y' ]]; then
  gem install bundle
  bundle install
  bundle update
  rm -f 'Gemfile.lock'
fi
if [[ "$npm" == 'y' ]]; then
  npm install -g $(cat Npmfile)
  npm cache clean
fi
if [[ "$tlmgr" == 'y' ]]; then
  tlmgr update --self
  tlmgr update --all
  tlmgr install $(cat Tlmgrfile)
fi

true
