#!/bin/sh

H=""
p=""
P="https"
u="$LOGNAME"

usage() {
cat <<EOF >&2
usage: $(basename "$0") [options]

options:
	-h
		show this help
	-H <host>
		use the host <host>
	-p <password>
		use the password <password>
	-P <protocol>
		use the protocol <protocol> (default: $P)
	-u <username>
		use the username <username> (default: $u)
EOF
exit 1
}

while getopts "hH:p:P:u:" opt; do
	case "$opt" in
	(H) H="$OPTARG" ;;
	(p) p="$OPTARG" ;;
	(P) P="$OPTARG" ;;
	(u) u="$OPTARG" ;;
	(*) usage ;;
	esac
done
shift $((OPTIND - 1))

if [ $# -ne 0 ] || [ -z "$H" ] || [ -z "$p" ]; then
	usage
fi

git credential approve <<EOF
host=$H
protocol=https
username=$LOGNAME
password=$p
EOF
