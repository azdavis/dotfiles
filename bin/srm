#!/bin/sh

set -eu

show_help() {
cat <<EOS
usage: $(basename "$0") [options] <path>...

options:
	-f
		ignore nonexistent files and arguments, never prompt
	-h
		show this help
	-r
		remove directories and their contents recursively
	-v
		explain what is being done
EOS
}

usage() {
	show_help 1>&2
	exit 1
}

f=""
r=false
v=""
while getopts "fhrv" opt; do
	case "$opt" in
	(f) f="-f" ;;
	(h) show_help && exit ;;
	(r) r=true ;;
	(v) v="-v" ;;
	(*) usage ;;
	esac
done
shift $((OPTIND - 1))

if [ $# -eq 0 ]; then
	usage
fi

if $r; then
	find "$@" -type f -exec shred $f $v -zn 4 -- {} \;
	rm -r $f $v -- "$@"
else
	shred $f $v -zun 4 -- "$@"
fi
