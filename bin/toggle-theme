#!/bin/sh

set -eu
. "$HOME/.config/lib/panic.sh"

if [ $# -ne 0 ]; then
	panic "usage: $(basename "$0")"
fi

cd "$HOME/.config"

p="sublime-text-3/Packages/User/light.patch"
t=""
d=""
if git apply --check "$p" > /dev/null 2>&1; then
	t="light"
	d=""
elif git apply --check --reverse "$p" > /dev/null 2>&1; then
	t="dark"
	d="--reverse"
else
	panic "patch does not apply in either direction"
fi

git apply $d "$p"
printf "\033]50;SetProfile=$t\a"
