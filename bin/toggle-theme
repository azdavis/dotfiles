#!/bin/sh

set -eu
. ~/.config/lib/panic.sh

if [ $# -ne 0 ]; then
	panic "usage: $(basename "$0")"
fi

cd ~/.config

p="theme/dark.patch"
t=""
d=""
if git apply --check "$p" > /dev/null 2>&1; then
	t="dark"
	d=""
elif git apply --check --reverse "$p" > /dev/null 2>&1; then
	t="light"
	d="--reverse"
else
	panic "patch does not apply in either direction"
fi

git apply $d "$p"
printf "\033]50;SetProfile=$t\a"
