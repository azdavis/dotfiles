#!/bin/sh

set -eu
. "$HOME/.config/lib/abort.sh"

git rev-parse

remote=""
if [ $# -eq 0 ]; then
	branch="$(git rev-parse --abbrev-ref @)"
	if ! remote="$(git config branch.$branch.remote)"; then
		remote="origin"
	fi
elif [ $# -eq 1 ]; then
	remote="$1"
else
	abort "usage: $(basename "$0") [<remote>]"
fi

if ! url="$(git config remote.$remote.url)"; then
	abort "could not get url for remote '$remote'"
fi
url="$(echo "$url" | sed 's/\.git$//')"

open "$url/tree/$branch"
