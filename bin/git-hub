#!/usr/bin/env sh

cd "$(cd "$(dirname "$0")" && pwd -P)"
source "../etc/base.sh"

get "username"
get "email"
get "token"

git config --global user.name "$username"
git config --global user.email "$email"

git credential-osxkeychain erase <<EOS
host=github.com
protocol=https
EOS
git credential-osxkeychain store <<EOS
host=github.com
protocol=https
password=$token
username=$username
EOS
cat <<EOS > "$HOME/.config/hub"
github.com:
- user: $username
  oauth_token: $token
  protocol: https
EOS
