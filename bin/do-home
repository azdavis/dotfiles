#!/bin/sh

set -eu
IFS=

# warning: set -f is NOT on, so the contents of variables better not have shell
# glob chars in them.

. $HOME/.config/lib/force_symlink.sh
. $HOME/.config/lib/panic.sh

if [ $# -ne 0 ]; then
    panic "usage: $(basename $0)"
fi

touch $HOME/.hushlogin
chmod 600 $HOME/.hushlogin

wd=.config/home
cd $HOME/$wd
for x in *; do
    force_symlink $wd/$x $HOME/.$x
done

cd
for x in .*; do
    if [ -L $x ] && ! [ -e $x ]; then
        rm $x
    fi
done
