#!/bin/sh

set -eu

panic() {
  echo "$1" >&2
  exit 1
}

if [ "$#" -ne 0 ]; then
  panic "usage: $0"
fi

symlink() {
  if [ -e "$2" ]; then
    printf 'rm %s [yn]? ' "$2"
    read ans
    if [ "$ans" != y ]; then
      return
    fi
  fi
  rm -rf "$2"
  mkdir -p "$(dirname "$2")"
  ln -s "$1" "$2"
}

touch "$HOME/.hushlogin"
chmod 600 "$HOME/.hushlogin"

if [ "$(uname)" = Darwin ]; then
  symlink "$HOME/.config/vscode" "/Applications/code-portable-data"
fi

symlink "$HOME/.config/home/zshrc" "$HOME/.zshrc"
symlink "$HOME/.config/home/Brewfile" "$HOME/.Brewfile"
