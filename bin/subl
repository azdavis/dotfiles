#!/usr/bin/env zsh

source "$HOME/.config/etc/base.sh" || exit 1

if pgrep -f "Sublime Text" > /dev/null; then
    abort "sublime text must not be running"
fi

support="$HOME/Library/Application Support/Sublime Text 3"
mkdir -p "$support/Packages"

sym "$HOME/.config/subl" "$support/Packages/User"
rm_file "$HOME/.config/subl/Package Control.cache"
rm_file "$support/Cache"
rm_file "$support/Local/Session.sublime_session"
rm_file "$support/Local/Auto Save Session.sublime_session"

sym \
    "/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl" \
    "/usr/local/bin/edit"

echo -n "install package control [yn]? " && read x
[[ "$x" == "y" ]] && open "https://packagecontrol.io/installation"

true
