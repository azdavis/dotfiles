#!/usr/bin/env sh

. "$HOME/.config/etc/base.sh"

pgrep -f "Sublime Text" > /dev/null \
    && abort "sublime text must not be running"

support="$HOME/Library/Application Support/Sublime Text 3"

mkdir -p "$support/Packages"
rm -f "$support/Local/Auto Save Session.sublime_session"
rm -f "$support/Local/Session.sublime_session"
rm -rf "$HOME/.config/subl/Package Control.cache"
rm -rf "$support/Cache"

dst="$support/Packages/User"

[ -L "$dst" ] && rm "$dst"
[ -e "$dst" ] && rm -ri "$dst"
[ -e "$dst" ] && exit 0
ln -s "$HOME/.config/subl" "$dst"
