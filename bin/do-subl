#!/bin/sh

. "$HOME/.config/lib/_base.sh"
. "$HOME/.config/lib/abort.sh"
. "$HOME/.config/lib/symlink.sh"

if pgrep -f "Sublime Text" > /dev/null; then
    abort "sublime text must not be running"
fi

config="$HOME/.config/sublime-text-3"
symlink "$config" "$HOME/Library/Application Support/Sublime Text 3"
rm -rf \
    "$config/Backup" \
    "$config/Cache" \
    "$config/Index" \
    "$config/Local/Auto Save Session.sublime_session" \
    "$config/Local/Session.sublime_session" \
    "$config/Packages/User/oscrypto-ca-bundle.crt" \
    "$config/Packages/User/Package Control.cache" \
    "$config/Packages/User/Package Control.last-run" \
    "$config/Packages/User/Package Control.merged-ca-bundle" \
    "$config/Packages/User/Package Control.user-ca-bundle"
